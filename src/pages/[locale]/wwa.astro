---
import Layout from '../../layouts/MainLayout.astro';
import Header from '../../components/Header.astro';
import FeatureCard from '../../components/FeatureCard.astro';
import MissionVisionCard from '../../components/MissionVisionCard.astro';
import { getLangFromUrl, useTranslations } from '../../i18n/utils';
import { languages, ui } from '../../i18n/ui';
import { getCollection, type CollectionEntry } from 'astro:content';

type TranslationKey = keyof typeof ui.en;

interface MissionVisionItem {
  icon: string;
  titleKey: TranslationKey;
  descriptionKey: TranslationKey;
}

interface WorkAreaItem {
  icon: string;
  titleKey: TranslationKey;
  descriptionKey: TranslationKey;
}

export async function getStaticPaths() {
  const wwaEntries = await getCollection('wwa');
  return Object.keys(languages).map((lang) => {
    const entry = wwaEntries.find((entry: CollectionEntry<'wwa'>) => entry.slug === lang);
    return {
      params: { locale: lang },
      props: { entry }
    };
  });
}

interface Props {
  entry: CollectionEntry<'wwa'>;
}

const { entry } = Astro.props;
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const { Content } = await entry.render();

const missionVision: MissionVisionItem[] = [
  {
    icon: "fas fa-bullseye",
    titleKey: "mission.title",
    descriptionKey: "mission.description"
  },
  {
    icon: "fas fa-eye",
    titleKey: "vision.title",
    descriptionKey: "vision.description"
  }
];

const workAreas: WorkAreaItem[] = [
  {
    icon: "fas fa-landmark",
    titleKey: "workareas.governance.title",
    descriptionKey: "workareas.governance.description"
  },
  {
    icon: "fas fa-chart-line",
    titleKey: "workareas.economic.title",
    descriptionKey: "workareas.economic.description"
  },
  {
    icon: "fas fa-users",
    titleKey: "workareas.migration.title",
    descriptionKey: "workareas.migration.description"
  },
  {
    icon: "fas fa-heart",
    titleKey: "workareas.health.title",
    descriptionKey: "workareas.health.description"
  },
  {
    icon: "fas fa-leaf",
    titleKey: "workareas.agriculture.title",
    descriptionKey: "workareas.agriculture.description"
  },
  {
    icon: "fas fa-laptop-code",
    titleKey: "workareas.technology.title",
    descriptionKey: "workareas.technology.description"
  }
];
---

<Layout 
  title={t('nav.wwa')}
  description={t('wwa.description')}
>
  <Header class="mx-auto w-full z-50" textColorNav="primary" />

  <main class="pt-10">
    <section class="mt-20 mb-12 bg-primary/10 max-w-6xl mx-auto">
      <div class="container md:py-8 mx-auto sm:px-4">
        <div class="flex flex-wrap">              
          <div class="md:w-3/4 p-6">
            <h1 class="text-primary uppercase border-l-4 border-secondary tracking-wider py-6 p-10">
              {t('nav.wwa')}
            </h1>
          </div>
        </div>
      </div>
    </section>

    <div class="container mx-auto px-4 max-w-6xl">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">
        {missionVision.map(item => (
          <MissionVisionCard
            icon={item.icon}
            title={t(item.titleKey)}
            description={t(item.descriptionKey)}
          />
        ))}
      </div>

      <!-- Áreas de Trabajo -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12">
        {workAreas.map(area => (
          <FeatureCard
            icon={area.icon}
            title={t(area.titleKey)}
            description={t(area.descriptionKey)}
          />
        ))}
      </div>

    </div>

    <article class="container px-2 lg:px-10 prose lg:prose-xl mx-auto max-w-5xl prose-headings:text-primary prose-headings:font-normal prose-headings:text-3xl">
      <Content />
    </article>
  </main>
</Layout>

<style>
  @import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css');
</style>

